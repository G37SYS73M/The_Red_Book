# Shadow Copies

A **Shadow Copy,** also known as **Volume Shadow Service (VSS)** is a Microsoft backup technology that allows creation of snapshots of files or entire volumes.

To manage volume shadow copies, the Microsoft signed binary **vshadow.exe i**s offered as part of the Windows SDK.

As domain admins, we have the ability to abuse the **vshadow** utility to create a Shadow Copy that will allow us to extract the Active Directory Database **NTDS.dit** database file. Once we've obtained a copy of said database, we can extract every user credential offline on our local Kali machine.

To start off, we'll connect as the jeffadmin domain admin user to the DC1 domain controller and launch from an elevated prompt the vshadow utility with **-nw** options to disable writers which speeds up backup creation and include the **-p** option to store the copy on disk.

```
vshadow.exe -nw -p  C:

copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy2\windows\ntds\ntds.dit c:\ntds.dit.bak

reg.exe save hklm\system c:\system.bak

impacket-secretsdump -ntds ntds.dit.bak -system system.bak LOCAL
```
